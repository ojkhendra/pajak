<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bayar Pajak Lebih Mudah</title>
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #e0e5ec;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
    }
    .container {
      width: 370px;
      background: #e0e5ec;
      border-radius: 25px;
      box-shadow: 9px 9px 16px #b8bcc2,
                  -9px -9px 16px #ffffff;
      overflow: hidden;
      padding: 20px;
    }
    .header {
      background: #2563eb;
      color: white;
      text-align: center;
      padding: 18px;
      font-size: 20px;
      font-weight: bold;
      border-radius: 15px;
      margin-bottom: 15px;
      box-shadow: inset 3px 3px 6px rgba(0,0,0,0.2),
                  inset -3px -3px 6px rgba(255,255,255,0.6);
    }
    .amount {
      text-align: center;
      margin-bottom: 15px;
    }
    .amount .price {
      font-size: 28px;
      font-weight: bold;
      color: #111827;
    }
    .amount p {
      margin: 5px 0;
      color: #555;
    }
    .list {
      margin: 10px 0;
    }
    .item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 16px;
      border-radius: 12px;
      margin: 8px 0;
      cursor: pointer;
      background: #e0e5ec;
      box-shadow: 5px 5px 10px #b8bcc2,
                  -5px -5px 10px #ffffff;
      transition: all 0.3s ease-in-out;
      text-decoration: none;
      color: inherit;
    }
    .item span {
      font-weight: 500;
      color: #111827;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .item small {
      color: #6b7280;
      font-size: 13px;
    }

    /* Hover background sesuai kategori */
    .info:hover { background: rgba(22,163,74,0.15); }
    .bank:hover { background: rgba(37,99,235,0.15); }
    .wallet:hover { background: rgba(147,51,234,0.15); }
    .market:hover { background: rgba(249,115,22,0.15); }
    .store:hover { background: rgba(220,38,38,0.15); }

    /* Dropdown */
    .dropdown-content {
      max-height: 0;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      border-radius: 12px;
      transition: max-height 0.4s ease;
    }
    .dropdown-content a {
      padding: 12px 16px;
      margin: 5px 0;
      border-radius: 12px;
      background: #e0e5ec;
      text-decoration: none;
      color: #111827;
      font-size: 14px;
      box-shadow: 4px 4px 8px #b8bcc2,
                  -4px -4px 8px #ffffff;
      display: flex;
      justify-content: space-between;
      transition: all 0.3s ease;
      padding-left: 32px;
      border-left: 3px solid #d1d5db;
    }
    .dropdown-content a span {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .dropdown-content a:hover { transform: scale(1.03); }

    .dropdown.active .dropdown-content { max-height: 300px; }

    /* Buttons */
    .buttons {
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    .btn {
      padding: 14px;
      border-radius: 12px;
      font-weight: bold;
      font-size: 15px;
      cursor: pointer;
      border: none;
      background: #e0e5ec;
      box-shadow: 6px 6px 12px #b8bcc2,
                  -6px -6px 12px #ffffff;
      transition: all 0.2s ease-in-out;
    }
    .btn:active {
      box-shadow: inset 4px 4px 6px #b8bcc2,
                  inset -4px -4px 6px #ffffff;
      transform: translateY(2px);
    }
    .btn-primary { color: #2563eb; }
    .btn-secondary { color: #111827; }

    /* Popup Modal */
    .modal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background: #fff;
      padding: 20px;
      border-radius: 15px;
      max-width: 300px;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      animation: fadeIn 0.3s ease-in-out;
    }
    .modal-content h3 {
      margin: 10px 0 5px;
      color: #111827;
    }
    .modal-icon img {
      width: 60px;
      height: 60px;
      margin-bottom: 10px;
      border-radius: 12px;
    }
    .modal-buttons {
      margin-top: 20px;
      display: flex;
      justify-content: space-between;
      gap: 10px;
    }
    .modal-buttons button {
      flex: 1;
      padding: 10px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
    }
    .btn-cancel { background: #e5e7eb; color: #111827; }
    .btn-store { background: #2563eb; color: white; }

    /* Animasi */
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60% { transform: translateX(-8px); }
      40%, 80% { transform: translateX(8px); }
    }
    .shake {
      animation: shake 0.5s ease;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">Bayar Pajak Lebih Mudah</div>

    <div class="amount">
      <p class="price">Rp 1.250.000</p>
      <p>Jatuh Tempo: 30 Sept 2025</p>
    </div>

    <div class="list">
      <!-- Info PKB -->
      <a href="https://bapenda.jatimprov.go.id/info/pkb" target="_blank" class="item info">
        <span><i class="fas fa-info-circle"></i> Info PKB</span>
        <span>›</span>
      </a>

      <!-- Dropdown Bank Transfer -->
      <div class="dropdown">
        <div class="item bank" onclick="toggleBankDropdown()">
          <span><i class="fas fa-university"></i> Bank Transfer</span>
          <span id="arrow-bank">▼</span>
        </div>
        <div class="dropdown-content">
          <a href="#" onclick="openApp('mandiri'); return false;"> <span>Mandiri</span> ›</a>
          <a href="#" onclick="openApp('bca'); return false;"> <span>BCA</span> ›</a>
        </div>
      </div>

      <!-- Dropdown E-Wallet -->
      <div class="dropdown">
        <div class="item wallet" onclick="toggleDropdown()">
          <span><i class="fas fa-wallet"></i> E-Wallet</span>
          <span id="arrow">▼</span>
        </div>
        <div class="dropdown-content">
          <a href="#" onclick="openApp('ovo'); return false;"><span>OVO</span> ›</a>
          <a href="#" onclick="openApp('dana'); return false;"><span>DANA</span> ›</a>
          <a href="#" onclick="openApp('gopay'); return false;"><span>GoPay</span> ›</a>
        </div>
      </div>

      <!-- Marketplace -->
      <a href="https://www.tokopedia.com/pajak/samsat" target="_blank" class="item market">
        <span><i class="fas fa-shopping-cart"></i> Marketplace</span>
        <small>Tokopedia</small>
      </a>

      <!-- Minimarket -->
      <a href="https://www.google.com/maps/search/indomaret+terdekat+dari+lokasi+saya/" 
         target="_blank" class="item store">
        <span><i class="fas fa-store"></i> Minimarket</span>
        <small>Indomaret Terdekat</small>
      </a>
    </div>

    <div class="buttons">
      <button class="btn btn-primary">Ingatkan Saya Tahun Depan</button>
      <button class="btn btn-secondary">Manfaat Pajak Saya</button>
    </div>
  </div>

  <!-- Popup Modal -->
  <div id="modal" class="modal">
    <div id="modalContent" class="modal-content">
      <div id="modalIcon" class="modal-icon">
        <img src="" alt="App Logo">
      </div>
      <h3 id="modalTitle">Aplikasi tidak terdeteksi</h3>
      <p id="modalText">Ingin membuka App Store?</p>
      <div class="modal-buttons">
        <button class="btn-cancel" onclick="closeModal()">Batal</button>
        <button class="btn-store" id="storeBtn">Buka Store</button>
      </div>
    </div>
  </div>

  <script>
    function toggleDropdown() {
      const dropdown = document.querySelectorAll('.dropdown')[1];
      dropdown.classList.toggle('active');
      const arrow = document.getElementById('arrow');
      arrow.textContent = dropdown.classList.contains('active') ? '▲' : '▼';
    }

    function toggleBankDropdown() {
      const dropdown = document.querySelectorAll('.dropdown')[0];
      dropdown.classList.toggle('active');
      const arrow = document.getElementById('arrow-bank');
      arrow.textContent = dropdown.classList.contains('active') ? '▲' : '▼';
    }

    let pendingStoreLink = "";

    function openApp(service) {
      const ua = navigator.userAgent.toLowerCase();
      const isIOS = /iphone|ipad|ipod/.test(ua);
      const isAndroid = /android/.test(ua);

      let deepLink = "";
      let storeLink = "";
      let intentLink = "";
      let appName = "";
      let appLogo = "";

      if (service === "mandiri") {
        deepLink = "mandirimobile://";
        storeLink = isIOS 
          ? "https://apps.apple.com/id/app/livin-by-mandiri/id1555414743"
          : "https://play.google.com/store/apps/details?id=id.bmri.livin";
        intentLink = "intent://#Intent;scheme=mandirimobile;package=id.bmri.livin;end";
        appName = "Livin' by Mandiri";
        appLogo = "https://seeklogo.com/images/B/bank-mandiri-logo-9E05F02D99-seeklogo.com.png";
      } else if (service === "bca") {
        deepLink = "bcamobile://";
        storeLink = isIOS
          ? "https://apps.apple.com/id/app/bca-mobile/id551587254"
          : "https://play.google.com/store/apps/details?id=com.bca";
        intentLink = "intent://#Intent;scheme=bcamobile;package=com.bca;end";
        appName = "BCA Mobile";
        appLogo = "https://seeklogo.com/images/B/bca-bank-central-asia-logo-6376A7C7E5-seeklogo.com.png";
      } else if (service === "ovo") {
        deepLink = "ovo://";
        storeLink = isIOS
          ? "https://apps.apple.com/id/app/ovo/id1142114207"
          : "https://play.google.com/store/apps/details?id=ovo.id";
        intentLink = "intent://#Intent;scheme=ovo;package=ovo.id;end";
        appName = "OVO";
        appLogo = "https://seeklogo.com/images/O/ovo-logo-0F2268B9C9-seeklogo.com.png";
      } else if (service === "dana") {
        deepLink = "danaid://";
        storeLink = isIOS
          ? "https://apps.apple.com/id/app/dana-dompet-digital-indonesia/id1437123008"
          : "https://play.google.com/store/apps/details?id=id.dana";
        intentLink = "intent://#Intent;scheme=danaid;package=id.dana;end";
        appName = "DANA";
        appLogo = "https://seeklogo.com/images/D/dana-wallet-logo-6A1E1F1E0B-seeklogo.com.png";
      } else if (service === "gopay") {
        deepLink = "gopay://";
        storeLink = isIOS
          ? "https://apps.apple.com/id/app/gopay-transfer-pulsa-tagihan/id6446321594"
          : "https://play.google.com/store/search?q=gopay&c=apps";
        intentLink = "intent://#Intent;scheme=gopay;package=com.gojek.app;end";
        appName = "GoPay";
        appLogo = "https://seeklogo.com/images/G/gopay-logo-15BC0F0E2E-seeklogo.com.png";
      }

      if (isAndroid) {
        window.location.href = intentLink;
      } else if (isIOS) {
        pendingStoreLink = storeLink;
        document.getElementById("storeBtn").onclick = () => {
          window.location.href = pendingStoreLink;
        };

        window.location.href = deepLink;

        // Kalau gagal dalam 1.5 detik, tampilkan modal dengan logo + animasi shake
        setTimeout(() => {
          if (!(document.hidden || document.webkitHidden)) {
            const modal = document.getElementById("modal");
            const modalContent = document.getElementById("modalContent");
            document.getElementById("modalTitle").textContent = appName + " tidak terdeteksi";
            document.getElementById("modalText").textContent = "Ingin membuka App Store?";
            document.getElementById("modalIcon").innerHTML = `<img src="${appLogo}" alt="${appName} Logo">`;
            modal.style.display = "flex";
            modalContent.classList.add("shake");
            setTimeout(() => modalContent.classList.remove("shake"), 600);
          }
        }, 1500);
      }
    }

    function closeModal() {
      document.getElementById("modal").style.display = "none";
    }
  </script>
</body>
</html>
